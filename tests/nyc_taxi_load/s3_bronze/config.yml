source:
  path: "s3a://nyc-august-batch-raw/yellow-taxi/full"
  type: "parquet"
  schema: "Y"
  options:
    header: 'NA'
    delimiter: 'NA'
    inferSchema: 'NA'
    multiline : 'NA'
    flatten : "NA"
  exclude_cols: []

target:
  type: "database"
  transformation : ["y","sql"]
  table: "bronze.yellow_tripdata_bronze"
  cred_lookup: "red_shift_qa"
  exclude_cols: ['source_file_name', 'etl_insert_ts','hash_key','cbd_congestion_fee']

validations:
  count_check:
    key_columns: ["vendorid","tpep_pickup_datetime","tpep_dropoff_datetime"]
  duplicate_check:
    key_columns: ["vendorid","tpep_pickup_datetime","tpep_dropoff_datetime"]
  null_check:
    null_columns: ["fare_amount","tip_amount"]
    num_records : 5
  uniqueness_check:
    unique_columns: ["tpep_pickup_datetime","tpep_dropoff_datetime"]
  data_compare_check:
    key_column: ["vendorid","tpep_pickup_datetime","tpep_dropoff_datetime"]
    validate_columns: ["na"]
    num_records: 100